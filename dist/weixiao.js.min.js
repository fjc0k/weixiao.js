/*!
 * weixiao.js v1.0.0 
 * (c) 2017 fjc0k
 * Released under the MIT License.
 */
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.Weixiao=e()}(this,function(){"use strict";var n=function(n,e){if(!n)throw new Error(e||"Expected true, got "+n)},e=function(n){void 0===n&&(n=10);for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split(""),t="",o=0;o<n;o++)t+=e[Math.floor(Math.random()*e.length)];return t},t=function(n){return"object"==typeof n?Object.keys(n).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}).join("&"):String(n)},o=function(o,r,i){return void 0===r&&(r={}),void 0===i&&(i="callback"),new Promise(function(c,u){n(o,"url can not be empty");var f,a;"string"==typeof r&&(i=r,r={}),f="jsonp"+e(6),r[i]=f,o+=(-1===o.indexOf("?")?"?":"&")+t(r),window[f]=function(n){c(n);try{delete window[f],document.body.removeChild(a)}catch(n){console.log(n)}},a=document.createElement("script"),a.src=o,a.async=!0,a.onerror=u,document.body.appendChild(a)})},r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},i=function(n,e){return e={exports:{}},n(e,e.exports),e.exports}(function(n){!function(e){function t(n,e){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}function o(n,e){return n<<e|n>>>32-e}function r(n,e,r,i,c,u){return t(o(t(t(e,n),t(i,u)),c),r)}function i(n,e,t,o,i,c,u){return r(e&t|~e&o,n,e,i,c,u)}function c(n,e,t,o,i,c,u){return r(e&o|t&~o,n,e,i,c,u)}function u(n,e,t,o,i,c,u){return r(e^t^o,n,e,i,c,u)}function f(n,e,t,o,i,c,u){return r(t^(e|~o),n,e,i,c,u)}function a(n,e){n[e>>5]|=128<<e%32,n[14+(e+64>>>9<<4)]=e;var o,r,a,d,p,s=1732584193,m=-271733879,l=-1732584194,h=271733878;for(o=0;o<n.length;o+=16)r=s,a=m,d=l,p=h,s=i(s,m,l,h,n[o],7,-680876936),h=i(h,s,m,l,n[o+1],12,-389564586),l=i(l,h,s,m,n[o+2],17,606105819),m=i(m,l,h,s,n[o+3],22,-1044525330),s=i(s,m,l,h,n[o+4],7,-176418897),h=i(h,s,m,l,n[o+5],12,1200080426),l=i(l,h,s,m,n[o+6],17,-1473231341),m=i(m,l,h,s,n[o+7],22,-45705983),s=i(s,m,l,h,n[o+8],7,1770035416),h=i(h,s,m,l,n[o+9],12,-1958414417),l=i(l,h,s,m,n[o+10],17,-42063),m=i(m,l,h,s,n[o+11],22,-1990404162),s=i(s,m,l,h,n[o+12],7,1804603682),h=i(h,s,m,l,n[o+13],12,-40341101),l=i(l,h,s,m,n[o+14],17,-1502002290),m=i(m,l,h,s,n[o+15],22,1236535329),s=c(s,m,l,h,n[o+1],5,-165796510),h=c(h,s,m,l,n[o+6],9,-1069501632),l=c(l,h,s,m,n[o+11],14,643717713),m=c(m,l,h,s,n[o],20,-373897302),s=c(s,m,l,h,n[o+5],5,-701558691),h=c(h,s,m,l,n[o+10],9,38016083),l=c(l,h,s,m,n[o+15],14,-660478335),m=c(m,l,h,s,n[o+4],20,-405537848),s=c(s,m,l,h,n[o+9],5,568446438),h=c(h,s,m,l,n[o+14],9,-1019803690),l=c(l,h,s,m,n[o+3],14,-187363961),m=c(m,l,h,s,n[o+8],20,1163531501),s=c(s,m,l,h,n[o+13],5,-1444681467),h=c(h,s,m,l,n[o+2],9,-51403784),l=c(l,h,s,m,n[o+7],14,1735328473),m=c(m,l,h,s,n[o+12],20,-1926607734),s=u(s,m,l,h,n[o+5],4,-378558),h=u(h,s,m,l,n[o+8],11,-2022574463),l=u(l,h,s,m,n[o+11],16,1839030562),m=u(m,l,h,s,n[o+14],23,-35309556),s=u(s,m,l,h,n[o+1],4,-1530992060),h=u(h,s,m,l,n[o+4],11,1272893353),l=u(l,h,s,m,n[o+7],16,-155497632),m=u(m,l,h,s,n[o+10],23,-1094730640),s=u(s,m,l,h,n[o+13],4,681279174),h=u(h,s,m,l,n[o],11,-358537222),l=u(l,h,s,m,n[o+3],16,-722521979),m=u(m,l,h,s,n[o+6],23,76029189),s=u(s,m,l,h,n[o+9],4,-640364487),h=u(h,s,m,l,n[o+12],11,-421815835),l=u(l,h,s,m,n[o+15],16,530742520),m=u(m,l,h,s,n[o+2],23,-995338651),s=f(s,m,l,h,n[o],6,-198630844),h=f(h,s,m,l,n[o+7],10,1126891415),l=f(l,h,s,m,n[o+14],15,-1416354905),m=f(m,l,h,s,n[o+5],21,-57434055),s=f(s,m,l,h,n[o+12],6,1700485571),h=f(h,s,m,l,n[o+3],10,-1894986606),l=f(l,h,s,m,n[o+10],15,-1051523),m=f(m,l,h,s,n[o+1],21,-2054922799),s=f(s,m,l,h,n[o+8],6,1873313359),h=f(h,s,m,l,n[o+15],10,-30611744),l=f(l,h,s,m,n[o+6],15,-1560198380),m=f(m,l,h,s,n[o+13],21,1309151649),s=f(s,m,l,h,n[o+4],6,-145523070),h=f(h,s,m,l,n[o+11],10,-1120210379),l=f(l,h,s,m,n[o+2],15,718787259),m=f(m,l,h,s,n[o+9],21,-343485551),s=t(s,r),m=t(m,a),l=t(l,d),h=t(h,p);return[s,m,l,h]}function d(n){var e,t="",o=32*n.length;for(e=0;e<o;e+=8)t+=String.fromCharCode(n[e>>5]>>>e%32&255);return t}function p(n){var e,t=[];for(t[(n.length>>2)-1]=void 0,e=0;e<t.length;e+=1)t[e]=0;var o=8*n.length;for(e=0;e<o;e+=8)t[e>>5]|=(255&n.charCodeAt(e/8))<<e%32;return t}function s(n){return d(a(p(n),8*n.length))}function m(n,e){var t,o,r=p(n),i=[],c=[];for(i[15]=c[15]=void 0,r.length>16&&(r=a(r,8*n.length)),t=0;t<16;t+=1)i[t]=909522486^r[t],c[t]=1549556828^r[t];return o=a(i.concat(p(e)),512+8*e.length),d(a(c.concat(o),640))}function l(n){var e,t,o="0123456789abcdef",r="";for(t=0;t<n.length;t+=1)e=n.charCodeAt(t),r+=o.charAt(e>>>4&15)+o.charAt(15&e);return r}function h(n){return unescape(encodeURIComponent(n))}function y(n){return s(h(n))}function g(n){return l(y(n))}function v(n,e){return m(h(n),h(e))}function b(n,e){return l(v(n,e))}function w(n,e,t){return e?t?v(e,n):b(e,n):t?y(n):g(n)}n.exports?n.exports=w:e.md5=w}(r)}),c=function(e,t){n("object"==typeof e,"params must be Object type"),n(t,"key can not be empty");var o=Object.keys(e).sort().map(function(n){return n+"="+e[n]}).join("&");return i(o+"&key="+t).toUpperCase()},u=function(n){n&&this.setApi(n)};return u.prototype.setApi=function(e){var t=e.key;void 0===t&&(t=null);var o=e.secret;void 0===o&&(o=null),n(t&&o,"both key and secret can not be empty"),this.api={key:t,secret:o}},u.prototype.getApi=function(){return this.api},u.prototype.getMediaInfo=function(t){var r=this;n(t,"media id can not be empty");var i={api_key:this.api.key,media_id:t,nonce_str:e(32),timestamp:Math.round(+new Date/1e3)};return i.sign=c(i,this.api.secret),new Promise(function(n,e){o("http://weixiao.qq.com/common/get_media_infop",i,"callback_name").then(function(o){o.errmsg?e(o.errmsg):(o.id=t,o.qrcode=r.getQRCode(t),n(o))},e)})},u.prototype.getQRCode=function(n){return"http://open.weixin.qq.com/qr/code/?username="+n},u});
